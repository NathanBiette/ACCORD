# Created by Octave 4.0.3, Mon Feb 06 10:07:47 2017 CET <felixgaschi@eduroam-0-230.enst.fr>
# name: main_code
# type: sq_string
# elements: 1
# length: 461
function [x, compteur]=multiplication_resolution4(V, W, H, beta, epsilon)
compteur = 0;
x = ((transpose(W)*(((W*H).^(beta-2)).*V))./(transpose(W)*((W*H).^(beta-1))));

Hprim = H + 2*epsilon*ones(size(H));


while abs(sum(Hprim)-sum(H))>epsilon
    Hprim = H;
    H = H.*x;
    x = ((transpose(W)*(((W*H).^(beta-2)).*V))./(transpose(W)*((W*H).^(beta-1))));
    
    compteur = compteur + 1;
    if compteur > 1000
        break;
    end;
end; 
x = H;
return;
end


# name: info
# type: sq_string
# elements: 1
# length: 20
../Data/essai03/info


# name: n
# type: scalar
512


# name: delta
# type: scalar
10000


# name: coefs
# type: matrix
# rows: 4
# columns: 251
 0.05393235853574653 0.02555069314784561 0.04043046308246188 0.03667308416452811 0.09044218906654622 0.0488514547450095 0.03587391608295351 0.05549008078947761 0.03573147258393669 0.04457604765347652 0.03085152400677591 0.0403568653875527 0.05274920361397422 0.04626172076469343 0.07957938123754564 0.06635627784454107 0.0636448360297554 0.08407968056794923 0.05382539960141931 0.08599982149779932 0.09952742316911385 0.1161688987033028 0.1093018618900102 0.1121099132746365 0.0999331386875502 0.09377113795779476 0.09848442699144971 0.08605606975449272 0.05666398163849241 0.07861925239948338 0.07262694287701262 0.08842613996099873 0.04017721054045437 0.03631826337601266 0.08886630348415755 0.1248222069700172 0.09123335795817951 0.04593277658309577 0.09190207880604948 0.3012058819765655 0.1353816274256162 0.1627390772918605 0.1821825143492942 0.1209473333245739 0.09806675982952631 0.0982764112552983 0.1639288623068352 0.2124369590140238 0.1377406416806644 0.1177146807306878 0.1126348793094685 0.1344026945480069 0.195632489171828 0.2551218534706519 0.1934932041143823 0.1998712224984301 0.09237078541796347 0.2294985316884722 0.147338346498417 0.2364805488667539 0.1633498309092641 0.2116952876556127 0.07166246688611552 0.2832587353060363 0.1521638260206152 0.08205159571997681 0.3813713557643287 0.2033109802125314 0.2284386270825956 0.2323978507987287 0.1156991518012643 0.2016906531835908 0.1948267336290866 0.2492415774211068 0.2563808221857821 0.2135505373954653 0.237821387926661 0.1503217889964959 0.1645961342284157 0.1092672067311231 0.1262389480755558 0.1353509794745878 0.09610083068349917 0.1103979218093915 0.1349090209681102 0.1476851608969047 0.1912722392105358 0.1758944228339554 0.0829253238600768 0.1287646114251687 0.4217313560571801 0.1787627524436521 0.05381204472060403 0.09525987083852276 0.1077897792054127 0.07947635152351275 0.2167793426324183 0.1201870926013302 0.1652640472776709 0.05850095230072191 0.2022405821925217 0.1543632839022034 0.06251078225573366 0.05383220492283639 0.09558300406167919 0.1647142310976162 0.3002530687192288 0.2256785984557802 0.1548498952155475 0.1825848191272935 0.1433548568656393 0.1848684685046449 0.1590336724157299 0.1924908123879724 0.1479643661029802 0.192887870176586 0.1168445684141267 0.0489590122020968 0.1967910089669283 0.1358596555734443 0.1513469462777659 0.1338310892196725 0.1662590242844444 0.09055155790052286 0.2013149087608483 0.2145907725440463 0.2532462771235816 0.2286972591414384 0.2661375423388591 0.2287150327240018 0.1917368079478907 0.1927375023354343 0.2001730664191235 0.4039361491447661 0.1059260132306227 0.121606751011972 0.09667458280674583 0.1217668233384239 0.08488780043908414 0.04749045162895339 0.2686818342425903 0.1429364927127951 0.1187454025892474 0.1233951430038328 0.266464068400034 0.1254902659640094 0.03995016079411551 0.09966222236390007 0.08263560490220578 0.09380119379025656 0.1027525603508671 0.1026809266940303 0.1811143165649977 0.06843790135539247 0.1421116109843228 0.1036211701754766 0.1124609601953393 0.1305805560132421 0.2832310962114918 0.1332485326246548 0.1494125281639133 0.1535099004858475 0.1021487969920608 0.3718598563939491 0.1314935047524912 0.1587404623613493 0.1929337339397495 0.1554039604250455 0.1913416454964644 0.1776072079928407 0.04724143863072401 0.2013004274325088 0.1371829961161303 0.2537125422002575 0.141759696373177 0.3085674746649927 0.2568882430334963 0.2043144399819922 0.1851584745262113 0.2336121098965645 0.2399365573517812 0.2468352762703132 0.2166708883229394 0.1132379770339488 0.1570556268330991 0.07426502634393978 0.1464014079671422 0.198912234433162 0.06756657970805427 0.1599947897686766 0.1019070319881372 0.02670004533715021 0.1417373329937129 0.1267640034770111 0.05888462746064039 0.185333021284241 0.04006915405522209 0.06080707588891544 0.05755354338320778 0.08824673458713998 0.04263238859212407 0.04867835354578812 0.04458907567108266 0.06346811589594809 0.06566909489712883 0.03665538659256862 0.04557932070882543 0.03874949707250172 0.01855867215874846 0.001604550477332938 0.00310890435054266 0.01938832824407417 0.01218791641128424 0.003180324384588369 0.01004161905075165 0.01797886523716844 0.1151350334554949 0.578616396376346 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0.08534992445693203 0.09454175793361694 0.0755458419652992 0.05697022193184349 0.09901366329432067 0.04925606740339241 0.0492911195117858 0.05343036820200343 0.02762283689456961 0.06278094726172782 0.07714320131709904 0.0462325505122031 0.08549981689931495 0.04326191265756027 0.07961741196472238 0.06453664864653127 0.06278450554137625 0.09578609419847134 0.05100413262117694 0.09544187055942474 0.09804446270773715 0.1167969539489713 0.11015757882673 0.08882514245241799 0.09695640937777569 0.0979652672994797 0.1153898244115932 0.1180882795929138 0.05215289069689234 0.06677839055194081 0.1612481619184509 0.1098254194446141 0.03700860924210263 6.563226266273798 0.08590398548702852 0.1293407918823596 0.3514025564569255 0.06100183073701142 3.068430293347582 0.5079754319915751 0.1451354678765605 0.1802985440961315 0.23442598529236 0.1520871464349162 0.09161752185908692 0.1088997342921634 0.1656067795560215 0.3710016393830333 2.071353814415859 0.2950274019982572 0.1774965268145101 0.1537108181038216 1.463393315670656 0.2392024105054866 0.2525767656244238 0.2069554173521842 4.440326190332603 0.2191516672207049 0.1304851332645501 0.2530249781683141 0.1691570671881223 0.2027580779666971 0.1109930554058672 0.2888985342535894 0.1763879773271302 0.1064139130409929 0.2767903287779153 0.1932389669977445 0.2676010166832365 0.2390130891985044 0.102379489154457 0.2175848918650989 0.2066810483459184 0.2520280421330125 0.1578273495480204 0.1721432395309688 0.163960564424443 0.1352048652217799 0.1356920236140387 0.09091176017035253 0.6361844605888647 0.1131716281210842 0.4120093180860391 0.1831416687857003 0.1591292735357964 0.5041562195750716 0.2234343891356319 0.1899186984497213 0.1250505762510499 0.1678746694051701 0.2003998301072096 0.1895704927341656 0.06906530990299424 0.09102175987199686 0.1082785793637172 0.1732781639714051 0.2494372077172286 0.1638814986113145 0.1546993292742359 0.0647643768464671 0.3102966941148674 0.05208585283188068 0.2378438887472916 6.966578814451413 0.08634842550269051 0.1414097469127809 0.2676848409437816 0.3974953570734648 0.2388340583325504 0.1846584313766952 0.110805952635963 0.1734277315844747 0.09619296342721559 0.2330453341030582 0.1511689808710209 0.4062580585523607 0.9191884963077168 2.531412548413552 1.438283561109969 1.007122040385478 0.1419032414448051 0.1655110816542792 0.1997580426333145 0.1597867550243346 0.1675755224738008 0.2341545077584051 0.2275730516188322 0.2260675322334277 0.4504380177496967 0.1627846671186828 0.1954485228622401 0.1405901090076681 0.2273681966469111 0.43886629744004 0.1391878091354397 0.2220602315705494 1.848500627633785 0.1672514004704254 0.3450487895056152 0.4115225966906589 0.2718700903940772 0.2021313605406428 0.1591094381745933 0.1149869606679245 1.109186715830641 0.1664492312764831 1.519311950653448 0.1162989716660697 0.08343806604298686 0.1047101344051343 0.1263810472586858 0.1623563151893075 0.1599501431033123 0.9257901433746777 0.2204123740147499 0.2549267404452559 0.1575823950393893 0.2650393493339361 0.6655037782614207 0.4530412894183267 0.07080813637275876 0.3521104776761671 1.122440920305708 0.3176417722062668 0.245329529843794 0.1821267716931891 0.8316423044606159 0.131135206577224 0.215952695057081 0.2182828331024819 0.03289575051930236 0.25058303071174 0.1598199511212406 1.01684296722658 0.132129449272178 0.2752718358372053 0.4266222512287791 0.09893136509912635 0.1834507870139662 0.1948719164309398 0.2446809728871877 0.2158476869635351 0.9637171625466598 1.684765747838783 0.1711284586986221 0.06515014460009927 0.1358662228199693 0.2600141298926072 0.9391649639935505 0.1889539439746036 0.1941227547780386 0.4522943256356862 0.7526124773230111 0.1206647509308662 0.1069281606085648 0.1997144547550137 1.203051522611641 0.8150741123131798 0.07054684053047294 0.1363834478529541 0.02990348472722063 0.2336590525403102 0.1188656644810102 0.06302100206010942 0.07133508727983785 0.04673523170930286 0.04182908989314384 0.04496749244631932 0.0147039345929635 0.007257755782478261 0.002644793855746598 0.01423918225217227 0.03292040296768931 0.01700357725528757 0.004735965874779137 0.0059200801280521 0.001586225363783792 0.0001481070019553518 0.01397245129118337 0.01506080738759746 0.03688043656200247 0.02670553125667195 0.03319370447914572 0.01174671920214281 0.02111809538249887 0.01679794581108315 0.01584390265752049 0.0230497103410394 0.03110227617063588 0.04792629599672679 0.06670549375721629 0.5716348240161074 0.5975375567241145 1.540989542821906 1.615589629144428 1.572012158346856 4.094044798660417 6.080577012729838 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1000795730788046 0.1364455804118534 0.02393043004317542 0.1243742201355068 1.053426776606948e-09 0.1294290218420733 0.02311195175427393 0.1447816852165346 0.04185156554303416 0.09927940822435335 0.1223858730517961 0.1273189633154549 0.1678733603690051 0.2222443903169527 0.109797362190493 0.05651719686370524 0.04215668039179125 0.02916906500185328 0.0353351818922293 0.02524276218274057 0.05250555195356815 0.0590333311875194 0.04398402873486301 0.06385551542863735 0.2269104197825118 0.2738933494844806 0.3229888106122742 0.09592414569418016 0.003899609415257464 0.09535247526787677 0.0001330796535196661 0.09518156372197985 0.1620073044726788 0.1890505368667697 0.1680225138204353 0.1933952101762599 0.09522306514512956 0.2280740454789793 0.1912340165601944 0.1133362836624884 0.1806891835441618 0.09354544749702999 0.1471493176183151 0.3198795503454507 0.2311498026967235 0.2975778990962704 0.2548137706009217 0.2045864357805134 0.1144806927829466 0.08844775189409948 0.1889929973682356 0.07061112000867101 0.2631670740415586 0.205901228926851 0.1411371874613443 0.01857173639211741 0.05381335911664091 0.1005442315141025 0.1112902397848119 0.03084548962186328 0.05733479062436349 0.08199743842901996 0.1059780971968813 0.04949604178561764 0.02776958389223242 0.1172009958040972 0.2110622327224159 0.1164007624866646 0.1537311178654082 0.1405155834633659 0.1984358656846618 0.1846595782670872 0.02390990623031841 0.04283219217905655 0.06745540878638923 0.05808054258378558 0.0001621750360493598 0.06289450241525725 0.05909413982463401 0.06886953901447238 0.1165954521864914 0.1713819190812428 0.1413700800176433 0.1850122080353687 0.1833101122877409 0.09785231538365437 0.2102109621288714 0.1318622916929643 0.0508897372397286 0.07087936311611615 0.2031951475125126 0.1198010347077988 0.2316274255763736 0.1793067446466753 0.056380399882466 0.02304517426158217 0.02600184491754908 0.04933667235196749 0.07795841391919908 0.2034676910350309 0.1665813235077544 0.2117761505386821 0.1671422382996819 0.1651008310787534 0.195596524171058 0.2353853483706975 0.1017234665998873 0.07206417195346038 0.03020903797307428 0.09626484585819337 0.0147403908202592 0.05004906147279753 0.03051559200787426 0.1743928685434414 0.2049340696332177 0.2438046689286779 0.2475695074452121 0.2105432396304664 0.224114626412884 0.06816264884583394 0.1517389026066908 0.1253360221011637 0.1233396752057341 0.06321811302937272 0.09583659807879398 0.106493643074767 0.2010175381326067 0.1781474378246171 0.1673728583177873 0.1787779982384139 0.2030188701810137 0.2271622792129215 0.252955724945638 0.1549513676401038 0.08365904633268041 0.06203081676470246 0.2028327053253949 0.1619581372934927 0.1391620593244878 0.006043650227514729 0.1160502946344614 0.08438506638493877 0.1692822951145289 0.2203000087549104 0.1981602677360345 0.1684257824936472 0.156080097916266 0.05409417239641059 0.1513726428018691 0.1162717730395607 0.1835901008670612 0.1667781313112471 0.1137361192894752 0.07220013342762244 0.04069030612761709 0.02256815992972405 0.01995295402693269 0.01163852655876789 0.002878642447652023 0.009962933874541049 0.006445018261764108 0.02078455053856496 0.01129315098734587 0.06006585088357195 0.253560273842194 0.06224670501044755 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0.06653561157359497 0.05106748104874337 0.06201338991292657 0.05766648632068583 0.06118355307956359 0.06205186734695477 0.05953961279400399 0.06328613537749793 0.07908956657557327 0.05778298676865588 0.09651389002521511 0.05473868439098117 0.07005756443322322 0.06675263178133356 0.07965467948431935 0.08196500698388134 0.06340115254936927 0.09302009116160116 0.08026500347401769 0.08761208653328784 0.08475640063847947 0.103924434437321 0.1092729376620482 0.0780950129042598 0.1153717910948601 0.09704344293966399 0.09162755090536667 0.1329765487363874 0.1161065876328773 0.08168909095884447 0.2048522881208403 0.1252130541146636 0.05617619445770737 0.141696708665605 0.1366892976435945 0.1040111827724846 0.08926649118766015 0.07508521842570809 0.08961707521260676 0.06455065296875682 0.1892613710535352 0.1825184491993719 0.1543371387963004 0.1548641000952797 0.1341090593966378 0.1423107052773688 0.1918108879060763 0.1525551756833674 0.2253566994628661 0.1668060620359461 0.1848481294422322 0.2265010375656502 0.1195727900133029 0.2335704658824853 0.3535247512406796 0.190905589022741 0.02333038135852182 0.1659529873065946 0.2015452151898887 0.2055209823254003 0.1745179758115838 0.1509909255163156 0.1133484278807197 0.2193606354152196 0.2054566555368847 0.1569372301791733 0.1703771668689576 0.2073770015480143 0.2200197731317822 0.3234859871205704 0.1608680001575812 0.1813549046468159 0.2022913455700674 0.2197700586206985 0.2139796259147757 0.1043491972615688 0.1593029100889483 0.1591662115970629 0.164084670455672 0.2185699808520089 0.2986705778868883 0.1065252070753746 0.2409585627674172 0.1868770295408444 0.1371667965336448 0.211717406290454 0.2357240450465236 0.1718084044816415 0.2486856543767365 0.1816440092492451 0.1100881161595274 0.08944439306264655 0.1319001501966386 0.1374735320945082 0.1670565515730303 0.1724427895048128 0.2392101473473713 0.234091870162146 0.1917050853114966 0.2384528707776647 0.1250532405032531 0.05828621179206144 0.2295088814638251 0.01697835814735756 0.1277255503767309 0.155915072268664 0.2532293083848089 0.1692153216345247 0.2833551997591283 0.1734454972916889 0.2638000522598842 0.1930018764806946 0.2617498349223896 0.2422908214842201 0.2646507149782916 0.1855773234491179 0.1585708253338634 0.196238297697004 0.1517019077261536 0.2735453971129166 0.208353482587952 0.1722673663275336 0.1968775136838762 0.1308961187624223 0.134315763260652 0.1405001830107233 0.2034700954798841 0.192589432011652 0.4604549984540087 0.1440593058098717 0.1483552203941375 0.1276653701937366 0.2847073281608316 0.1292907648464499 0.1642087510176541 0.2226359316131005 0.05627473800054478 0.1894868616771402 0.1978919485719592 0.1336818237234531 0.1288476056197935 0.2801965036396372 0.1674422114212492 0.2390355959307696 0.1221208817328365 0.176897693864578 0.1890900614694766 0.1212728367954925 0.07429220301007677 0.08151559723489278 0.1243611949012468 0.1526449771352825 0.1480027641529718 0.1847858765081238 0.239772644026699 0.2479140530882687 0.1826598278856041 0.2262222032938458 0.1406332155628348 0.3026566836252372 0.3501963260559511 0.2315138782742447 0.3221295501449957 0.2465747350039451 0.3457949326567355 0.2159450476094432 0.1667339141712902 0.1495112606887399 0.2099128106521733 0.2254293346467833 0.1857505926586042 0.1855523064267152 0.1644171637398436 0.199562115966265 0.1674599122078005 0.2930654643637771 0.126749479928839 0.09033721669871318 0.1785961169893427 0.186041595136706 0.2584691571153278 0.2428936473330272 0.1804326938558219 0.03849001046199484 0.1902265801350031 0.1536551448389075 0.120785201008479 0.2396715102381698 0.08266716961554342 0.1812311075674067 0.1709976308999444 0.2095025195327788 0.08586543265803259 0.3304870180489373 0.1756399340371053 0.1999531588293149 0.0770900531222297 0.01679448022647378 0.1234439376696192 0.1827543546989414 0.1525650643559428 0.2131597917975183 0.1222717009825086 0.09295545480580748 0.07681077895520778 0.04224186930269689 0.03896829155047308 0.04022342490211921 0.01082202715746498 0.003561538555898079 0.003092799087007085 0.0235169372694446 0.0297381918571173 0.01046027924695627 0.007461279921482233 0.003972516587944026 0.01803233197210908 0.05953837273797669 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0


# name: temps_traitement
# type: scalar
0.2790842056274414


# name: compteurs
# type: matrix
# rows: 1
# columns: 251
 2 3 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 3 2 3 2 2 65 2 2 19 2 109 13 3 2 4 2 2 2 2 7 41 8 4 5 39 2 3 2 28 3 4 2 3 4 2 7 2 2 6 3 5 3 3 3 2 4 8 7 5 4 4 8 29 2 10 2 2 15 2 2 4 2 6 5 3 2 2 3 2 4 2 6 3 6 7 189 3 2 2 7 3 2 6 3 7 2 2 8 44 47 46 47 2 2 2 2 4 3 2 3 8 5 2 6 3 3 2 2 31 2 6 17 3 3 2 4 52 2 51 3 2 3 3 3 2 17 4 6 4 4 20 14 9 11 25 7 4 3 24 2 2 2 5 2 2 17 2 3 5 4 2 4 2 2 38 60 3 4 2 3 23 2 2 14 24 7 3 2 37 20 4 3 2 5 3 3 2 2 2 2 2 2 2 2 2 2 2 4 7 8 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0 0 0 0 0 0 0 0 0 0 0 0 0


# name: beta
# type: scalar
2


# name: epsilon
# type: scalar
0.01


